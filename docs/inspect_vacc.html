<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="JJC">

<title>Excess Mortality in Scotland - Inspect Vaccinations Dataset</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Inspect Vaccinations Dataset</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/covid19_variant.jpeg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="https://phinancetechnologies.com/HumanityProjects/Humanity%20projects.asp" rel="" title="Humanity Projects" class="quarto-navigation-tool px-1" aria-label="Humanity Projects"><i class="bi bi-globe"></i></a>
    <a href="https://github.com/jjcoen/vax-scotland" rel="" title="Data and Analysis" class="quarto-navigation-tool px-1" aria-label="Data and Analysis"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Load and Transform Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./explore.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-sources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Sources</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#daily-vaccinations-by-age-group-jan-2021---sept-2022" id="toc-daily-vaccinations-by-age-group-jan-2021---sept-2022" class="nav-link active" data-scroll-target="#daily-vaccinations-by-age-group-jan-2021---sept-2022">Daily Vaccinations by age group, Jan 2021 - Sept 2022</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jjcoen/vax-scotland/edit/main/inspect_vacc.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/jjcoen/vax-scotland/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Inspect Vaccinations Dataset</h1>
<p class="subtitle lead">for daily (Jan 21 - Sept 22) and weekly (Sept 22 - present) counts</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>JJC </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Five year age categories:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>age_5yr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"0-4"</span>, <span class="st">"5-9"</span>, <span class="st">"10-14"</span>, <span class="st">"15-19"</span>, <span class="st">"20-24"</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"25-29"</span>, <span class="st">"30-34"</span>, <span class="st">"35-39"</span>, <span class="st">"40-44"</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"45-49"</span>, <span class="st">"50-54"</span>, <span class="st">"55-59"</span>, <span class="st">"60-64"</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"65-69"</span>, <span class="st">"70-74"</span>, <span class="st">"75-79"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"80-84"</span>, <span class="st">"85-89"</span>, <span class="st">"90 plus"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="daily-vaccinations-by-age-group-jan-2021---sept-2022" class="level2">
<h2 class="anchored" data-anchor-id="daily-vaccinations-by-age-group-jan-2021---sept-2022">Daily Vaccinations by age group, Jan 2021 - Sept 2022</h2>
<div class="cell">
<details>
<summary>Input daily vacc data and remove rows for Male and Female. Using total numbers only</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>daily_vacc <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">"./raw-data/daily_vacc_age_sex_sept_2022.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>daily_vacc <span class="ot">&lt;-</span> daily_vacc[Sex <span class="sc">==</span> <span class="st">"Total"</span>,]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(daily_vacc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Date"                         "Country"                     
 [3] "Sex"                          "SexQF"                       
 [5] "AgeGroup"                     "AgeGroupQF"                  
 [7] "Population"                   "PopulationQF"                
 [9] "Dose"                         "DoseQF"                      
[11] "NumberVaccinated"             "NumberVaccinatedQF"          
[13] "PercentCoverage"              "PercentCoverageQF"           
[15] "CumulativeNumberVaccinated"   "CumulativeNumberVaccinatedQF"
[17] "CumulativePercentCoverage"    "CumulativePercentCoverageQF" </code></pre>
</div>
</div>
<p>Select relevant columns only</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>daily_vacc[, <span class="fu">c</span>(<span class="st">"Sex"</span>, <span class="st">"SexQF"</span>, <span class="st">"AgeGroupQF"</span>, <span class="st">"Population"</span>, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">"PopulationQF"</span>, <span class="st">"DoseQF"</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">"NumberVaccinatedQF"</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"PercentCoverage"</span>, <span class="st">"PercentCoverageQF"</span>, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"CumulativeNumberVaccinated"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">"CumulativeNumberVaccinatedQF"</span>, </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">"CumulativePercentCoverage"</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">"CumulativePercentCoverageQF"</span>) <span class="sc">:</span><span class="er">=</span> <span class="cn">NULL</span>]</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(daily_vacc) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       Date   Country          AgeGroup   Dose NumberVaccinated
1: 20201208 S92000003 12 years and over Dose 1             1907
2: 20201208 S92000003 12 years and over Dose 2                0
3: 20201208 S92000003 12 years and over Dose 3                0
4: 20201208 S92000003 12 years and over Dose 4                0
5: 20201208 S92000003 12 years and over Dose 5                0
6: 20201208 S92000003          18 to 29 Dose 1              157</code></pre>
</div>
</div>
<p>Remove rows where no vaccination occurred.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>daily_vacc <span class="ot">&lt;-</span> daily_vacc[NumberVaccinated <span class="sc">!=</span> <span class="dv">0</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Remove rows where no age group is given</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>daily_vacc <span class="ot">&lt;-</span> daily_vacc[<span class="sc">!</span>(AgeGroup <span class="sc">==</span> <span class="st">""</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="overview" class="level3">
<h3 class="anchored" data-anchor-id="overview">Overview</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(daily_vacc, <span class="dv">20</span>) <span class="sc">|&gt;</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="gjndhbyjya" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gjndhbyjya table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gjndhbyjya thead, #gjndhbyjya tbody, #gjndhbyjya tfoot, #gjndhbyjya tr, #gjndhbyjya td, #gjndhbyjya th {
  border-style: none;
}

#gjndhbyjya p {
  margin: 0;
  padding: 0;
}

#gjndhbyjya .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gjndhbyjya .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gjndhbyjya .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gjndhbyjya .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gjndhbyjya .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gjndhbyjya .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gjndhbyjya .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gjndhbyjya .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gjndhbyjya .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gjndhbyjya .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gjndhbyjya .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gjndhbyjya .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gjndhbyjya .gt_spanner_row {
  border-bottom-style: hidden;
}

#gjndhbyjya .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gjndhbyjya .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gjndhbyjya .gt_from_md > :first-child {
  margin-top: 0;
}

#gjndhbyjya .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gjndhbyjya .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gjndhbyjya .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gjndhbyjya .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gjndhbyjya .gt_row_group_first td {
  border-top-width: 2px;
}

#gjndhbyjya .gt_row_group_first th {
  border-top-width: 2px;
}

#gjndhbyjya .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gjndhbyjya .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gjndhbyjya .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gjndhbyjya .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gjndhbyjya .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gjndhbyjya .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gjndhbyjya .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gjndhbyjya .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gjndhbyjya .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gjndhbyjya .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gjndhbyjya .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gjndhbyjya .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gjndhbyjya .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gjndhbyjya .gt_left {
  text-align: left;
}

#gjndhbyjya .gt_center {
  text-align: center;
}

#gjndhbyjya .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gjndhbyjya .gt_font_normal {
  font-weight: normal;
}

#gjndhbyjya .gt_font_bold {
  font-weight: bold;
}

#gjndhbyjya .gt_font_italic {
  font-style: italic;
}

#gjndhbyjya .gt_super {
  font-size: 65%;
}

#gjndhbyjya .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gjndhbyjya .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gjndhbyjya .gt_indent_1 {
  text-indent: 5px;
}

#gjndhbyjya .gt_indent_2 {
  text-indent: 10px;
}

#gjndhbyjya .gt_indent_3 {
  text-indent: 15px;
}

#gjndhbyjya .gt_indent_4 {
  text-indent: 20px;
}

#gjndhbyjya .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Date">Date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Country">Country</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="AgeGroup">AgeGroup</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Dose">Dose</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="NumberVaccinated">NumberVaccinated</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Date" class="gt_row gt_right">20201208</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">12 years and over</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">1907</td></tr>
    <tr><td headers="Date" class="gt_row gt_right">20201208</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">18 to 29</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">157</td></tr>
    <tr><td headers="Date" class="gt_row gt_right">20201208</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">18 years and over</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">1907</td></tr>
    <tr><td headers="Date" class="gt_row gt_right">20201208</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">30 to 39</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">368</td></tr>
    <tr><td headers="Date" class="gt_row gt_right">20201208</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">40 to 49</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">497</td></tr>
    <tr><td headers="Date" class="gt_row gt_right">20201208</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">40 years and over</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">1382</td></tr>
    <tr><td headers="Date" class="gt_row gt_right">20201208</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">50 to 54</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">293</td></tr>
    <tr><td headers="Date" class="gt_row gt_right">20201208</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">55 to 59</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">325</td></tr>
    <tr><td headers="Date" class="gt_row gt_right">20201208</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">60 to 64</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">197</td></tr>
    <tr><td headers="Date" class="gt_row gt_right">20201208</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">65 to 69</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">56</td></tr>
    <tr><td headers="Date" class="gt_row gt_right">20201208</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">70 to 74</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">12</td></tr>
    <tr><td headers="Date" class="gt_row gt_right">20201208</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">75 to 79</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">2</td></tr>
    <tr><td headers="Date" class="gt_row gt_right">20201208</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">All vaccinations</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">1907</td></tr>
    <tr><td headers="Date" class="gt_row gt_right">20201208</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">Total</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">2</td></tr>
    <tr><td headers="Date" class="gt_row gt_right">20201209</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">12 years and over</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">3814</td></tr>
    <tr><td headers="Date" class="gt_row gt_right">20201209</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">18 to 29</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">434</td></tr>
    <tr><td headers="Date" class="gt_row gt_right">20201209</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">18 years and over</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">3814</td></tr>
    <tr><td headers="Date" class="gt_row gt_right">20201209</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">30 to 39</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">736</td></tr>
    <tr><td headers="Date" class="gt_row gt_right">20201209</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">40 to 49</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">928</td></tr>
    <tr><td headers="Date" class="gt_row gt_right">20201209</td>
<td headers="Country" class="gt_row gt_left">S92000003</td>
<td headers="AgeGroup" class="gt_row gt_left">40 years and over</td>
<td headers="Dose" class="gt_row gt_left">Dose 1</td>
<td headers="NumberVaccinated" class="gt_row gt_right">2644</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>The “Total” age group is misleading. The number receiving all doses is recorded in the “All vaccinations” category.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>daily_vacc <span class="ot">&lt;-</span> daily_vacc[AgeGroup <span class="sc">!=</span> <span class="st">"Total"</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="age-groups" class="level3">
<h3 class="anchored" data-anchor-id="age-groups">Age groups</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>n_age_groups <span class="ot">&lt;-</span> daily_vacc[, <span class="fu">unique</span>(AgeGroup)] <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">length</span>()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>daily_vacc[, <span class="fu">unique</span>(AgeGroup)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "12 years and over" "18 to 29"          "18 years and over"
 [4] "30 to 39"          "40 to 49"          "40 years and over"
 [7] "50 to 54"          "55 to 59"          "60 to 64"         
[10] "65 to 69"          "70 to 74"          "75 to 79"         
[13] "All vaccinations"  "80 years and over" "16 to 17"         
[16] "12 to 15"          "5 to 11"          </code></pre>
</div>
</div>
<p>14 age categories in use by Humanity Projects:</p>
<p>0-4 5-9 10-14 15-19 20-24 25-49 50-59 60-69 70-79 80+</p>
<p>0-14 15-24 &lt;20 45-64</p>
<p>Only certain <code>AgeGroups</code> are compatible with Humanity Projects age categorisation:</p>
<pre><code>"50 to 54"  "55 to 59" "60 to 64" "65 to 69" "70 to 74" "75 to 79"   
"All vaccinations"    "80 years and over"</code></pre>
<p>Number of days when records were taken.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(n_days <span class="ot">&lt;-</span> daily_vacc[<span class="fu">unique</span>(Date), .N])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 643</code></pre>
</div>
</div>
<p>Collapse <code>Dose</code> column so as to record <code>NumberVaccinated</code> for all doses given by age group and date. The number of observations should equal to the number of days times the number of age groups</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>daily_vacc_all_dose <span class="ot">&lt;-</span> daily_vacc[, .(<span class="at">Num_Vacc =</span> <span class="fu">sum</span>(NumberVaccinated)),</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                                  by <span class="ot">=</span> .(Date, AgeGroup)]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>n_days <span class="sc">*</span> n_age_groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10931</code></pre>
</div>
</div>
<p>Since the number of observations (10,135) is less that the 10,931 then not every age group is recorded on each day.</p>
<p>Check whether the age groups above are recorded for each day in the data set</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 636 days only</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>daily_vacc_all_dose[AgeGroup <span class="sc">==</span> <span class="st">"50 to 54"</span>, .N]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 636 days only</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>daily_vacc_all_dose[AgeGroup <span class="sc">==</span> <span class="st">"55 to 59"</span>, .N]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 631 days only</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>daily_vacc_all_dose[AgeGroup <span class="sc">==</span> <span class="st">"60 to 64"</span>, .N]</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 613 days only</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>daily_vacc_all_dose[AgeGroup <span class="sc">==</span> <span class="st">"70 to 74"</span>, .N]</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 611 days only</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>daily_vacc_all_dose[AgeGroup <span class="sc">==</span> <span class="st">"75 to 79"</span>, .N]</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 614 days only</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>daily_vacc_all_dose[AgeGroup <span class="sc">==</span> <span class="st">"80 years and over"</span>, .N]</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 634 days only</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>daily_vacc_all_dose[AgeGroup <span class="sc">==</span> <span class="st">"Total"</span>, .N]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="aggregate-daily-to-weekly" class="level3">
<h3 class="anchored" data-anchor-id="aggregate-daily-to-weekly">Aggregate daily to weekly</h3>
<div class="cell">
<details>
<summary>Convert column named ‘Date’ from integer to the class Date</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>daily_vacc_all_dose[, Date <span class="sc">:</span><span class="er">=</span> <span class="fu">ymd</span>(Date)]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(daily_vacc_all_dose)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         Date          AgeGroup Num_Vacc
1: 2020-12-08 12 years and over     1907
2: 2020-12-08          18 to 29      157
3: 2020-12-08 18 years and over     1907
4: 2020-12-08          30 to 39      368
5: 2020-12-08          40 to 49      497
6: 2020-12-08 40 years and over     1382</code></pre>
</div>
</div>
<p>The <code>floor_date()</code> function starts recording weeks in 2021 on 3 Jan.&nbsp;Remove observations prior to that date.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>daily_vacc_all_dose <span class="ot">&lt;-</span> daily_vacc_all_dose[Date <span class="sc">&gt;=</span> <span class="fu">ymd</span>(<span class="dv">20210103</span>), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Aggregate numbers vaccinated for the first week by age group</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>first_week <span class="ot">&lt;-</span> daily_vacc_all_dose[Date <span class="sc">&lt;</span> <span class="fu">ymd</span>(<span class="dv">20210110</span>), <span class="fu">sum</span>(Num_Vacc), by <span class="ot">=</span> AgeGroup]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(first_week)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">AgeGroup</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">12 years and over</td>
<td style="text-align: right;">48729</td>
</tr>
<tr class="even">
<td style="text-align: left;">18 to 29</td>
<td style="text-align: right;">4881</td>
</tr>
<tr class="odd">
<td style="text-align: left;">18 years and over</td>
<td style="text-align: right;">48722</td>
</tr>
<tr class="even">
<td style="text-align: left;">30 to 39</td>
<td style="text-align: right;">7657</td>
</tr>
<tr class="odd">
<td style="text-align: left;">40 to 49</td>
<td style="text-align: right;">8951</td>
</tr>
<tr class="even">
<td style="text-align: left;">40 years and over</td>
<td style="text-align: right;">36184</td>
</tr>
<tr class="odd">
<td style="text-align: left;">50 to 54</td>
<td style="text-align: right;">6054</td>
</tr>
<tr class="even">
<td style="text-align: left;">55 to 59</td>
<td style="text-align: right;">6575</td>
</tr>
<tr class="odd">
<td style="text-align: left;">60 to 64</td>
<td style="text-align: right;">4988</td>
</tr>
<tr class="even">
<td style="text-align: left;">65 to 69</td>
<td style="text-align: right;">2066</td>
</tr>
<tr class="odd">
<td style="text-align: left;">70 to 74</td>
<td style="text-align: right;">627</td>
</tr>
<tr class="even">
<td style="text-align: left;">75 to 79</td>
<td style="text-align: right;">659</td>
</tr>
<tr class="odd">
<td style="text-align: left;">80 years and over</td>
<td style="text-align: right;">6264</td>
</tr>
<tr class="even">
<td style="text-align: left;">All vaccinations</td>
<td style="text-align: right;">48729</td>
</tr>
<tr class="odd">
<td style="text-align: left;">16 to 17</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">12 to 15</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>There is no record for the “5 to 11” group in the first week.</p>
<p>Aggregate for all weeks:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>daily_vacc_all_dose<span class="sc">$</span>Week <span class="ot">&lt;-</span> <span class="fu">floor_date</span>(daily_vacc_all_dose<span class="sc">$</span>Date, <span class="st">"week"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Check the aggregated numbers for the first week</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(floor1 <span class="ot">&lt;-</span> daily_vacc_all_dose[Week <span class="sc">==</span> <span class="st">"2021-01-03"</span>, <span class="fu">sum</span>(Num_Vacc), <span class="at">by =</span> AgeGroup] )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             AgeGroup    V1
 1: 12 years and over 48729
 2:          18 to 29  4881
 3: 18 years and over 48722
 4:          30 to 39  7657
 5:          40 to 49  8951
 6: 40 years and over 36184
 7:          50 to 54  6054
 8:          55 to 59  6575
 9:          60 to 64  4988
10:          65 to 69  2066
11:          70 to 74   627
12:          75 to 79   659
13: 80 years and over  6264
14:  All vaccinations 48729
15:          16 to 17     6
16:          12 to 15     1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>first_week[, V1] <span class="sc">==</span> floor1[, V1]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
[16] TRUE</code></pre>
</div>
</div>
<p>Aggregate numbers vaccinated for all weeks</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>weekly_vacc <span class="ot">&lt;-</span> daily_vacc_all_dose[, <span class="fu">sum</span>(Num_Vacc), </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                                   by <span class="ot">=</span> .(Week, AgeGroup)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="humanity-projects-age-groups" class="level3">
<h3 class="anchored" data-anchor-id="humanity-projects-age-groups">Humanity Projects Age Groups</h3>
<p>HP uses the 50-59 60-69 70-79 80+ and Total categories</p>
<p>Filter age groups that correspond with Humanity Projects categorisation</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>matching_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"50 to 54"</span>, <span class="st">"55 to 59"</span>, <span class="st">"60 to 64"</span>,<span class="st">"65 to 69"</span>, </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"70 to 74"</span>, <span class="st">"75 to 79"</span>, <span class="st">"All vaccinations"</span>, <span class="st">"80 years and over"</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>weekly_vacc <span class="ot">&lt;-</span> weekly_vacc[AgeGroup <span class="sc">%in%</span> matching_groups,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The <code>combineLevels()</code> function from <em>rockchalk</em> puts factor levels together and creates a new factor variable. Author: Paul E. Johnson pauljohn@ku.edu</p>
<p>Usage: <code>combineLevels(fac, levs, newLabel = "combinedLevels")</code></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rockchalk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'rockchalk'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:Hmisc':

    summarize</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    summarize</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>weekly_vacc[, AgeGroup <span class="sc">:</span><span class="er">=</span> <span class="fu">as.factor</span>(AgeGroup)]</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(weekly_vacc<span class="sc">$</span>AgeGroup)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "50 to 54"          "55 to 59"          "60 to 64"         
[4] "65 to 69"          "70 to 74"          "75 to 79"         
[7] "80 years and over" "All vaccinations" </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>weekly_vacc<span class="sc">$</span>AgeGroup <span class="ot">&lt;-</span> <span class="fu">combineLevels</span>(weekly_vacc<span class="sc">$</span>AgeGroup, </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">levs =</span> <span class="fu">c</span>(<span class="st">"50 to 54"</span>, <span class="st">"55 to 59"</span>),</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">newLabel =</span> <span class="st">"Age50_59"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The original levels 50 to 54 55 to 59 60 to 64 65 to 69 70 to 74 75 to 79 80 years and over All vaccinations 
have been replaced by 60 to 64 65 to 69 70 to 74 75 to 79 80 years and over All vaccinations Age50_59 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>weekly_vacc<span class="sc">$</span>AgeGroup <span class="ot">&lt;-</span> <span class="fu">combineLevels</span>(weekly_vacc<span class="sc">$</span>AgeGroup, </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">levs =</span> <span class="fu">c</span>(<span class="st">"60 to 64"</span>, <span class="st">"65 to 69"</span>),</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">newLabel =</span> <span class="st">"Age60_69"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The original levels 60 to 64 65 to 69 70 to 74 75 to 79 80 years and over All vaccinations Age50_59 
have been replaced by 70 to 74 75 to 79 80 years and over All vaccinations Age50_59 Age60_69 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>weekly_vacc<span class="sc">$</span>AgeGroup <span class="ot">&lt;-</span> <span class="fu">combineLevels</span>(weekly_vacc<span class="sc">$</span>AgeGroup, </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">levs =</span> <span class="fu">c</span>(<span class="st">"70 to 74"</span>, <span class="st">"75 to 79"</span>),</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">newLabel =</span> <span class="st">"Age70_79"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The original levels 70 to 74 75 to 79 80 years and over All vaccinations Age50_59 Age60_69 
have been replaced by 80 years and over All vaccinations Age50_59 Age60_69 Age70_79 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename: change "All vaccinations" to "All"</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(weekly_vacc<span class="sc">$</span>AgeGroup)[<span class="fu">levels</span>(weekly_vacc<span class="sc">$</span>AgeGroup)<span class="sc">==</span><span class="st">"All vaccinations"</span>] <span class="ot">&lt;-</span> <span class="st">"All"</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename: change "80 years and over" to "Age80+"</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(weekly_vacc<span class="sc">$</span>AgeGroup)[<span class="fu">levels</span>(weekly_vacc<span class="sc">$</span>AgeGroup)<span class="sc">==</span><span class="st">"80 years and over"</span>] <span class="ot">&lt;-</span> <span class="st">"Age80+"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Sum the combined levels by Date</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>weekly_vacc[, Num_Vacc <span class="sc">:</span><span class="er">=</span> V1][, V1 <span class="sc">:</span><span class="er">=</span> <span class="cn">NULL</span>]</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>weekly_vacc[, Num_Vacc <span class="sc">:</span><span class="er">=</span> <span class="fu">sum</span>(Num_Vacc), by <span class="ot">=</span> .(AgeGroup, Week)]</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep distinct rows only</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>weekly_vacc <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(weekly_vacc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="yearly-totals" class="level3">
<h3 class="anchored" data-anchor-id="yearly-totals">Yearly Totals</h3>
<p><strong>2021</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>weekly_vacc[Week <span class="sc">&gt;=</span> <span class="st">"2021-01-03"</span> <span class="sc">&amp;</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                Week <span class="sc">&lt;=</span> <span class="st">"2021-12-26"</span>, <span class="fu">sum</span>(Num_Vacc), </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>            by <span class="ot">=</span> AgeGroup]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   AgeGroup       V1
1: Age50_59  2097900
2: Age60_69  1951541
3: Age70_79  1457342
4:   Age80+   785296
5:      All 10992475</code></pre>
</div>
</div>
<p>Our World in Data gives the cumulative number of vaccinations for 2021 at 11.39 Million.</p>
<p><a href="https://ourworldindata.org/grapher/cumulative-covid-vaccinations?country=~Scotland" title="Check value at 31 Dec 2021">OWD: Scotland Vaccinations</a></p>
<p><strong>2022</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>weekly_vacc[Week <span class="sc">&gt;=</span> <span class="st">"2022-01-02"</span> <span class="sc">&amp;</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                Week <span class="sc">&lt;=</span> <span class="st">"2022-08-28"</span>, <span class="fu">sum</span>(Num_Vacc), </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>            by <span class="ot">=</span> AgeGroup]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   AgeGroup      V1
1: Age50_59   74122
2: Age60_69   20339
3:      All 1574738
4: Age70_79    7493
5:   Age80+    5952</code></pre>
</div>
</div>
</section>
<section id="construct-excel-table" class="level3">
<h3 class="anchored" data-anchor-id="construct-excel-table">Construct Excel Table</h3>
<p>HP records age categories as separate columns.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>weekly_excel <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(weekly_vacc, <span class="at">names_from =</span> AgeGroup,</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">values_from =</span> Num_Vacc)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(weekly_excel, <span class="at">path =</span> <span class="st">"./processed-data/all_doses_by_AG.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© CC-Based on Openscapes, 2022</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This page is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>